# Large Dataset Processing Performance Test
# This test creates and processes a large dataset to identify bottlenecks

print("=== LARGE DATASET PROCESSING PERFORMANCE TEST ===")
print("Creating large dataset with 10,000 rows...")

# Create large dataset
let large_data = []
let headers = ['id', 'employee_name', 'department', 'salary', 'age', 'performance_score', 'hire_date', 'location']

# Generate 10,000 rows of realistic employee data
for i in range(10000) {
    let dept_id = i - (i / 15) * 15
    let salary_mod = i - (i / 75000) * 75000
    let age_mod = i - (i / 43) * 43
    let perf_mod = i - (i / 100) * 100
    let date_mod = i - (i / 28) * 28
    let loc_mod = i - (i / 8) * 8

    let row = [
        i,
        'Employee_' + i,
        'Department_' + dept_id,
        45000 + salary_mod,
        22 + age_mod,
        perf_mod / 100.0,
        '2020-01-' + (date_mod + 1),
        'Location_' + loc_mod
    ]
    push(large_data, row)
}

print("Dataset created. Creating table...")
let employees = table(large_data, headers)
print("Table created successfully!")

# Test 1: Column access performance
print("Testing column access performance...")
let names = employees['employee_name']
let salaries = employees['salary']
let departments = employees['department']
let ages = employees['age']
print("Column access completed.")

# Test 2: Table slicing operations
print("Testing table slicing operations...")
let first_1000 = table_head(employees, 1000)
let last_500 = table_tail(employees, 500)
print("Table slicing completed.")

# Test 3: Data analysis operations
print("Testing data analysis operations...")
let salary_sum = sum(salaries)
let avg_age = average(ages)
let unique_departments = unique(departments)
print("Data analysis completed.")

# Test 4: Complex data processing
print("Testing complex data processing...")
let high_performers = []
let performance_scores = employees['performance_score']
let employee_names = employees['employee_name']
for i in range(len(performance_scores)) {
    if performance_scores[i] > 0.8 {
        push(high_performers, employee_names[i])
    }
}

print("Complex processing completed.")

# Results summary
print("=== PERFORMANCE TEST RESULTS ===")
print("Total employees processed:", len(employees['id']))
print("Total salary sum:", salary_sum)
print("Average age:", avg_age)
print("Unique departments:", len(unique_departments))
print("High performers count:", len(high_performers))

print("Large dataset performance test completed successfully!")
