# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –≤ DataCode
# table_query(), table_between(), table_in(), table_is_null(), table_not_null()

print('üîç –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–∞–±–ª–∏—Ü –≤ DataCode')
print('============================================')
print()

# –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Ç–∞–±–ª–∏—Ü—É —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
global test_data = [
    ['Alice', 30, 50000, 'Engineering', 'New York'],
    ['Bob', 25, 45000, 'Marketing', null],
    ['Charlie', 35, 60000, 'Engineering', 'London'],
    ['Diana', 28, null, 'Sales', 'Paris'],
    ['Eve', 32, 52000, 'Marketing', 'New York'],
    ['Frank', 40, 70000, 'Engineering', null],
    ['Grace', 27, 48000, 'Sales', 'Tokyo']
]
global test_headers = ['name', 'age', 'salary', 'department', 'city']
global test_table = table(test_data, test_headers)

print('–ò—Å—Ö–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞:')
show_table(test_table)
print()

# 1. –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤)
print('1Ô∏è‚É£ –°–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤):')
print('==========================================')

# –ó–∞–ø—Ä–æ—Å: –≤–æ–∑—Ä–∞—Å—Ç –º–µ–∂–¥—É 25 –∏ 35 (–∏—Å–ø–æ–ª—å–∑—É–µ–º table_between)
global age_range = table_between(test_table, 'age', 25, 35)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 25 –¥–æ 35:')
show_table(age_range)
print()

# –ó–∞–ø—Ä–æ—Å: –æ—Ç–¥–µ–ª Engineering –ò–õ–ò Marketing (–∏—Å–ø–æ–ª—å–∑—É–µ–º table_in)
global dept_filter = table_in(test_table, 'department', ['Engineering', 'Marketing'])
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ Engineering –∏–ª–∏ Marketing:')
show_table(dept_filter)
print()

# –ó–∞–ø—Ä–æ—Å: –∑–∞—Ä–ø–ª–∞—Ç–∞ –±–æ–ª—å—à–µ 50000 –ò –≤–æ–∑—Ä–∞—Å—Ç –º–µ–Ω—å—à–µ 35 (–∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —Ñ–∏–ª—å—Ç—Ä–æ–≤)
global high_salary = table_where(test_table, 'salary', '>', 50000)
global complex_filter = table_where(high_salary, 'age', '<', 35)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π > 50000 –∏ –≤–æ–∑—Ä–∞—Å—Ç–æ–º < 35:')
show_table(complex_filter)
print()

# 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É (table_between)
print('2Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É (table_between):')
print('=============================================')

# –í–æ–∑—Ä–∞—Å—Ç –æ—Ç 28 –¥–æ 35
global age_between = table_between(test_table, 'age', 28, 35)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 28 –¥–æ 35:')
show_table(age_between)
print()

# –ó–∞—Ä–ø–ª–∞—Ç–∞ –æ—Ç 48000 –¥–æ 60000
global salary_between = table_between(test_table, 'salary', 48000, 60000)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π –æ—Ç 48000 –¥–æ 60000:')
show_table(salary_between)
print()

# 3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π (table_in)
print('3Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π (table_in):')
print('===========================================')

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥–æ–≤
global cities = ['New York', 'London', 'Tokyo']
global city_filter = table_in(test_table, 'city', cities)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ New York, London –∏–ª–∏ Tokyo:')
show_table(city_filter)
print()

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤
global departments = ['Engineering', 'Sales']
global dept_filter2 = table_in(test_table, 'department', departments)
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∏–∑ Engineering –∏–ª–∏ Sales:')
show_table(dept_filter2)
print()

# 4. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è NULL –∑–Ω–∞—á–µ–Ω–∏–π (table_is_null)
print('4Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è NULL –∑–Ω–∞—á–µ–Ω–∏–π (table_is_null):')
print('==============================================')

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –±–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
global no_city = table_is_null(test_table, 'city')
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –±–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞:')
show_table(no_city)
print()

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –±–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã
global no_salary = table_is_null(test_table, 'salary')
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –±–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã:')
show_table(no_salary)
print()

# 5. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ù–ï NULL –∑–Ω–∞—á–µ–Ω–∏–π (table_not_null)
print('5Ô∏è‚É£ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ù–ï NULL –∑–Ω–∞—á–µ–Ω–∏–π (table_not_null):')
print('=================================================')

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º
global has_city = table_not_null(test_table, 'city')
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º:')
show_table(has_city)
print()

# –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π
global has_salary = table_not_null(test_table, 'salary')
print('–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ —Å —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π:')
show_table(has_salary)
print()

# 6. –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
print('6Ô∏è‚É£ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤:')
print('=============================')

# –°–Ω–∞—á–∞–ª–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –æ—Ç–¥–µ–ª—É
global engineering_only = table_where(test_table, 'department', '==', 'Engineering')
print('–¢–æ–ª—å–∫–æ Engineering:')
show_table(engineering_only)
print()

# –ó–∞—Ç–µ–º —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É
global engineering_age = table_between(engineering_only, 'age', 30, 40)
print('Engineering –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 30 –¥–æ 40:')
show_table(engineering_age)
print()

# –ò —É–±–∏—Ä–∞–µ–º NULL –∑–Ω–∞—á–µ–Ω–∏—è
global engineering_complete = table_not_null(engineering_age, 'city')
print('Engineering –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ 30-40 —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º:')
show_table(engineering_complete)
print()

# 7. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
print('7Ô∏è‚É£ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö')
print('======================================')

global function analyze_employees(emp_table) do
    print('–ê–Ω–∞–ª–∏–∑ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:')
    print('===================')
    
    # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
    local total = len(emp_table)
    print('–í—Å–µ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤:', total)
    
    # –° –∑–∞—Ä–ø–ª–∞—Ç–æ–π
    local with_salary = table_not_null(emp_table, 'salary')
    print('–° —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç–æ–π:', len(with_salary))
    
    # –ë–µ–∑ –∑–∞—Ä–ø–ª–∞—Ç—ã
    local without_salary = table_is_null(emp_table, 'salary')
    print('–ë–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –∑–∞—Ä–ø–ª–∞—Ç—ã:', len(without_salary))
    
    # –° –≥–æ—Ä–æ–¥–æ–º
    local with_city = table_not_null(emp_table, 'city')
    print('–° —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º:', len(with_city))
    
    # –í—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ)
    if len(with_salary) > 0 do
        local high_salary = table_where(with_salary, 'salary', '>', 55000)
        print('–° –∑–∞—Ä–ø–ª–∞—Ç–æ–π > 55000:', len(high_salary))
    endif
    
    # –ú–æ–ª–æ–¥—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
    local young = table_between(emp_table, 'age', 25, 30)
    print('–í –≤–æ–∑—Ä–∞—Å—Ç–µ 25-30:', len(young))
    
    print()
endfunction

analyze_employees(test_table)

# 8. –ü—Ä–∏–º–µ—Ä: –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º
print('8Ô∏è‚É£ –ü—Ä–∏–º–µ—Ä: –ø–æ–∏—Å–∫ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º')
print('==========================================')

# –ò—â–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ:
# - –í –≤–æ–∑—Ä–∞—Å—Ç–µ –æ—Ç 28 –¥–æ 35
# - –° –∑–∞—Ä–ø–ª–∞—Ç–æ–π –±–æ–ª—å—à–µ 50000
# - –ò–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –æ—Ç–¥–µ–ª–æ–≤
# - –° —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º

global step1 = table_between(test_table, 'age', 28, 35)
global step2 = table_where(step1, 'salary', '>', 50000)
global step3 = table_in(step2, 'department', ['Engineering', 'Marketing'])
global step4 = table_not_null(step3, 'city')

print('–†–µ–∑—É–ª—å—Ç–∞—Ç –º–Ω–æ–≥–æ—Å—Ç—É–ø–µ–Ω—á–∞—Ç–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏:')
print('1. –í–æ–∑—Ä–∞—Å—Ç 28-35:', len(step1))
print('2. + –ó–∞—Ä–ø–ª–∞—Ç–∞ > 50000:', len(step2))
print('3. + Engineering –∏–ª–∏ Marketing:', len(step3))
print('4. + –° —É–∫–∞–∑–∞–Ω–Ω—ã–º –≥–æ—Ä–æ–¥–æ–º:', len(step4))
print()

if len(step4) > 0 do
    print('–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:')
    show_table(step4)
endif
print()

print('‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!')
print('–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –¥–∞–Ω–Ω—ã–º')

