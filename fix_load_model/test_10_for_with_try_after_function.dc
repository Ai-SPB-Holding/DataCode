# –¢–µ—Å—Ç 10: for —Å try –≤–Ω—É—Ç—Ä–∏ –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏
print("–¢–µ—Å—Ç 10: for —Å try –≤–Ω—É—Ç—Ä–∏ –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏")
print("========================================")

# –ö–æ–¥ –ø–µ—Ä–µ–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π
print("–ö–æ–¥ –ø–µ—Ä–µ–¥ —Ñ—É–Ω–∫—Ü–∏–µ–π")

# –§—É–Ω–∫—Ü–∏—è —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Ü–∏–∫–ª–∞–º–∏
global function merge_tables(tables) do
    if len(tables) == 0 do
        return null
    endif
    
    local headers = table_headers(tables[0])
    local all_rows = []
    
    for table in tables do
        for row in table do
            all_rows = push(all_rows, row)
        next row
    next table
    
    return table_create(all_rows, headers)
endfunction

# –ö–æ–¥ –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏
print("–ö–æ–¥ –ø–æ—Å–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏")

# –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
global base_path = getcwd() / "model_data"

print("üìä –ó–∞–≥—Ä—É–∑–∫–∞ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≥–æ–¥–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ model_data
global year_dirs = list_files(base_path)
print("  –ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ model_data: ", len(year_dirs))

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≥–æ–¥–∞
for year_dir in year_dirs do
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª—ã –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    if year_dir != "docs" and year_dir != "__pycache__" and year_dir != "generate_model_data.py" and not contains(year_dir, ".") do
        local year_str = year_dir
        local year_path = base_path / year_str
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –≤ –≥–æ–¥—É
        try
            local month_dirs = list_files(year_path)
            print("  –ì–æ–¥ ", year_str, ": –Ω–∞–π–¥–µ–Ω–æ ", len(month_dirs), " —ç–ª–µ–º–µ–Ω—Ç–æ–≤")
        catch e
            print("  ‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω –≥–æ–¥ ", year_str, ": ", e)
        endtry
    endif
next year_dir

print("‚úì –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω")

