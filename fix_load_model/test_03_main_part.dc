# –¢–µ—Å—Ç 3: –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–π
print("–¢–µ—Å—Ç 3: –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –±–µ–∑ —Ñ—É–Ω–∫—Ü–∏–π")
print("=================================")

# –ë–∞–∑–æ–≤—ã–π –ø—É—Ç—å –∫ –¥–∞–Ω–Ω—ã–º
global base_path = getcwd() / "model_data"
global docs_path = base_path / "docs"

print("üìÇ –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤...")
# –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏
global product_catalog = read_file(docs_path / "product_catalog.csv")
global regions = read_file(docs_path / "regions.csv")
global employees = read_file(docs_path / "employees.csv")

print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: ", len(product_catalog))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ä–µ–≥–∏–æ–Ω–æ–≤: ", len(regions))
print("  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤: ", len(employees))
print()

print("üìä –ó–∞–≥—Ä—É–∑–∫–∞ –µ–∂–µ–º–µ—Å—è—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
# –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≥–æ–¥–æ–≤ –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ model_data
global year_dirs = list_files(base_path)
print("  –ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ model_data: ", len(year_dirs))

# –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –µ–∂–µ–º–µ—Å—è—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
global all_sales_tables = []
global all_inventory_tables = []
global all_refunds_tables = []
global all_marketing_tables = []

# –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≥–æ–¥–∞
for year_dir in year_dirs do
    # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ñ–∞–π–ª—ã –∏ —Å–ª—É–∂–µ–±–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
    if year_dir != "docs" and year_dir != "__pycache__" and year_dir != "generate_model_data.py" and not contains(year_dir, ".") do
        local year_str = year_dir
        local year_path = base_path / year_str
        
        # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –º–µ—Å—è—Ü–µ–≤ –≤ –≥–æ–¥—É
        try
            local month_dirs = list_files(year_path)
            print("  –ì–æ–¥ ", year_str, ": –Ω–∞–π–¥–µ–Ω–æ ", len(month_dirs), " —ç–ª–µ–º–µ–Ω—Ç–æ–≤")
        catch e
            print("  ‚ö†Ô∏è  –ü—Ä–æ–ø—É—â–µ–Ω –≥–æ–¥ ", year_str, ": ", e)
        endtry
    endif
next year_dir

print("‚úì –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω")

