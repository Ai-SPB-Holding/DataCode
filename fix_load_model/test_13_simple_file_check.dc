# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
# –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ—á–µ–º—É —Å–∫—Ä–∏–ø—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã

print("============================================================")
print("–¢–ï–°–¢ 13: –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤")
print("============================================================")
print()

global base_path = getcwd() / "model_data"

# –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ —Ñ–∞–π–ª—ã
local problematic = [
    ["2025", "09", "refunds_2025_09.csv"],
    ["2024", "06", "marketing_spend_2024_06.csv"],
    ["2023", "03", "inventory_2023_03.csv"]
]

print("üìÇ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤...")
print()

for file_info in problematic do
    local year = file_info[0]
    local month = file_info[1]
    local filename = file_info[2]
    
    print("–§–∞–π–ª: ", filename)
    print("  –ü—É—Ç—å: ", year, "/", month)
    
    local month_dir = base_path / year / month
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤
    try
        local files = list_files(month_dir)
        print("  ‚úì –ù–∞–π–¥–µ–Ω–æ —Ñ–∞–π–ª–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: ", len(files))
        print("  ‚úì –§–∞–π–ª—ã: ", files)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –Ω–∞—à —Ñ–∞–π–ª
        local found = false
        for file in files do
            if file == filename do
                found = true
                break
            endif
        next file
        
        if found do
            print("  ‚úì –§–∞–π–ª –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ!")
            
            # –ü—ã—Ç–∞–µ–º—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å
            try
                local file_path = month_dir / filename
                local data = read_file(file_path)
                print("  ‚úì –§–∞–π–ª —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—á–∏—Ç–∞–Ω: ", len(data), " —Å—Ç—Ä–æ–∫")
            catch e
                print("  ‚úó –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è: ", e)
            endtry
        else
            print("  ‚úó –§–∞–π–ª –ù–ï –Ω–∞–π–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ!")
            print("  ‚ö†Ô∏è  –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –æ–Ω –Ω–µ –±—ã–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω")
        endif
    catch e
        print("  ‚úó –û—à–∏–±–∫–∞ list_files: ", e)
    endtry
    
    print()
next file_info

print("============================================================")
print("‚úÖ –¢–ï–°–¢ 13 –ó–ê–í–ï–†–®–ï–ù")
print("============================================================")
print()
print("üí° –í—ã–≤–æ–¥:")
print("  –ï—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ —Å–ø–∏—Å–∫–µ - –æ–Ω–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç")
print("  –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –±—ã–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã")
print("  –°–∫—Ä–∏–ø—Ç load_model_data.dc –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç–æ")

